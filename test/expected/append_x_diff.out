--make sure diff only has explain output not result output
\! diff ../results/append_unoptimized.out ../results/append.out 
1c1
< SET timescaledb.disable_optimizations = ON;
---
> SET timescaledb.disable_optimizations = OFF;
49,60c49,55
<                                     QUERY PLAN                                    
< ----------------------------------------------------------------------------------
<  Append
<    ->  Seq Scan on append_test
<          Filter: ("time" > (now_s() + '@ 1 mon'::interval))
<    ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<          Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
<    ->  Index Scan using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<          Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
<    ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<          Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
< (9 rows)
---
> psql:include/append.sql:44: NOTICE:  Stable function now_s() called!
>              QUERY PLAN              
> -------------------------------------
>  Custom Scan (ConstraintAwareAppend)
>    Hypertable: append_test
>    Chunks left after exclusion: 0
> (3 rows)
68,69d62
< psql:include/append.sql:45: NOTICE:  Stable function now_s() called!
< psql:include/append.sql:45: NOTICE:  Stable function now_s() called!
82,83c75,77
<                                        QUERY PLAN                                       
< ----------------------------------------------------------------------------------------
---
> psql:include/append.sql:50: NOTICE:  Stable function now_s() called!
>                 QUERY PLAN                 
> -------------------------------------------
85,95c79,82
<    ->  Merge Append
<          Sort Key: append_test."time" DESC
<          ->  Index Scan using append_test_time_idx on append_test
<                Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
<          ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<                Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
<          ->  Index Scan using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<                Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
<          ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<                Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
< (11 rows)
---
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: append_test
>          Chunks left after exclusion: 0
> (4 rows)
107,118c94,103
<                                     QUERY PLAN                                    
< ----------------------------------------------------------------------------------
<  Append
<    ->  Seq Scan on append_test
<          Filter: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
< (9 rows)
---
> psql:include/append.sql:57: NOTICE:  Stable function now_s() called!
>                                        QUERY PLAN                                       
> ----------------------------------------------------------------------------------------
>  Custom Scan (ConstraintAwareAppend)
>    Hypertable: append_test
>    Chunks left after exclusion: 1
>    ->  Append
>          ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
>                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
> (6 rows)
128d112
< psql:include/append.sql:60: NOTICE:  Stable function now_s() called!
143,144c127,129
<                                            QUERY PLAN                                            
< -------------------------------------------------------------------------------------------------
---
> psql:include/append.sql:66: NOTICE:  Stable function now_s() called!
>                                               QUERY PLAN                                               
> -------------------------------------------------------------------------------------------------------
146,156c131,138
<    ->  Merge Append
<          Sort Key: append_test."time"
<          ->  Index Scan Backward using append_test_time_idx on append_test
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<          ->  Index Scan Backward using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<          ->  Index Scan Backward using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<          ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
< (11 rows)
---
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: append_test
>          Chunks left after exclusion: 1
>          ->  Merge Append
>                Sort Key: _hyper_1_3_chunk."time"
>                ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
>                      Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
> (8 rows)
167,168d148
< psql:include/append.sql:70: NOTICE:  Stable function now_s() called!
< psql:include/append.sql:70: NOTICE:  Stable function now_s() called!
202,203c182,183
<                             QUERY PLAN                             
< -------------------------------------------------------------------
---
>                                QUERY PLAN                                
> -------------------------------------------------------------------------
206,215c186,196
<    ->  Append
<          ->  Seq Scan on append_test
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
<          ->  Seq Scan on _hyper_1_1_chunk
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
<          ->  Seq Scan on _hyper_1_2_chunk
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
<          ->  Seq Scan on _hyper_1_3_chunk
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
< (11 rows)
---
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: append_test
>          Chunks left after exclusion: 3
>          ->  Append
>                ->  Seq Scan on _hyper_1_1_chunk
>                      Filter: ("time" > (now_v() - '@ 2 mons'::interval))
>                ->  Seq Scan on _hyper_1_2_chunk
>                      Filter: ("time" > (now_v() - '@ 2 mons'::interval))
>                ->  Seq Scan on _hyper_1_3_chunk
>                      Filter: ("time" > (now_v() - '@ 2 mons'::interval))
> (12 rows)
241,242d221
< psql:include/append.sql:96: NOTICE:  Stable function now_s() called!
< psql:include/append.sql:96: NOTICE:  Stable function now_s() called!
250,262c229,239
<                                         QUERY PLAN                                         
< -------------------------------------------------------------------------------------------
<  Merge Append
<    Sort Key: append_test."time"
<    ->  Index Scan Backward using append_test_time_idx on append_test
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan Backward using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan Backward using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
< (10 rows)
---
> psql:include/append.sql:99: NOTICE:  Stable function now_s() called!
>                                            QUERY PLAN                                            
> -------------------------------------------------------------------------------------------------
>  Custom Scan (ConstraintAwareAppend)
>    Hypertable: append_test
>    Chunks left after exclusion: 1
>    ->  Merge Append
>          Sort Key: _hyper_1_3_chunk."time"
>          ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
>                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
> (7 rows)
290a268
> psql:include/append.sql:112: NOTICE:  Stable function now_s() called!
297c275,277
<          ->  Result
---
>          ->  Custom Scan (ConstraintAwareAppend)
>                Hypertable: append_test
>                Chunks left after exclusion: 2
299,302d278
<                      ->  Seq Scan on append_test
<                            Filter: ("time" > (now_s() - '@ 4 mons'::interval))
<                      ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<                            Index Cond: ("time" > (now_s() - '@ 4 mons'::interval))
307c283
< (14 rows)
---
> (12 rows)
358,359c334,337
<                                          QUERY PLAN                                         
< --------------------------------------------------------------------------------------------
---
> psql:include/append.sql:141: NOTICE:  Stable function now_s() called!
> psql:include/append.sql:141: NOTICE:  Stable function now_s() called!
>                                             QUERY PLAN                                            
> --------------------------------------------------------------------------------------------------
362,380c340,356
<    ->  Append
<          ->  Seq Scan on append_test a
<                Filter: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk a_1
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk a_2
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk a_3
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<    ->  Append
<          ->  Seq Scan on join_test j
<                Filter: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_2_4_chunk_join_test_time_idx on _hyper_2_4_chunk j_1
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_2_5_chunk_join_test_time_idx on _hyper_2_5_chunk j_2
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_2_6_chunk_join_test_time_idx on _hyper_2_6_chunk j_3
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
< (20 rows)
---
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: append_test
>          Chunks left after exclusion: 1
>          ->  Append
>                ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk a_1
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: join_test
>          Chunks left after exclusion: 3
>          ->  Append
>                ->  Index Scan using _hyper_2_4_chunk_join_test_time_idx on _hyper_2_4_chunk j_1
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
>                ->  Index Scan using _hyper_2_5_chunk_join_test_time_idx on _hyper_2_5_chunk j_2
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
>                ->  Index Scan using _hyper_2_6_chunk_join_test_time_idx on _hyper_2_6_chunk j_3
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
> (18 rows)
