 setup_meta 
------------
 
(1 row)

 setup_main 
------------
 
(1 row)

 setup_main 
------------
 
(1 row)

\c meta
SELECT add_cluster_user('postgres', NULL);
 add_cluster_user 
------------------
 
(1 row)

SELECT set_meta('meta' :: NAME, 'localhost');
 set_meta 
----------
 
(1 row)

SELECT add_node('Test1' :: NAME, 'localhost');
 add_node 
----------
 
(1 row)

SELECT add_node('test2' :: NAME, 'localhost');
 add_node 
----------
 
(1 row)

\c Test1 
CREATE TABLE PUBLIC."testNs" (
  time BIGINT NOT NULL,
  "Device_id" TEXT NOT NULL,
  temp DOUBLE PRECISION NULL,
  occupied BOOLEAN NULL,
  latitude BIGINT NULL,
  really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_and_on_and_on BIGINT NULL
);
CREATE INDEX ON PUBLIC."testNs" ("Device_id", time DESC NULLS LAST) WHERE "Device_id" IS NOT NULL;
CREATE INDEX ON PUBLIC."testNs" (temp, time DESC NULLS LAST) WHERE temp IS NOT NULL;
CREATE INDEX ON PUBLIC."testNs" (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_and_on_and_on, time DESC NULLS LAST) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_and_on_and_on IS NOT NULL;
CREATE INDEX ON PUBLIC."testNs" (time DESC NULLS LAST, really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_and_on_and_on) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_and_on_and_on IS NOT NULL;
SELECT * FROM create_hypertable('"public"."testNs"', 'time', 'Device_id', hypertable_name=>'testNs');
  name  | main_schema_name | main_table_name | associated_schema_name | associated_table_prefix | root_schema_name | root_table_name | distinct_schema_name | distinct_table_name | replication_factor | placement | time_column_name | time_column_type | created_on | chunk_size_bytes 
--------+------------------+-----------------+------------------------+-------------------------+------------------+-----------------+----------------------+---------------------+--------------------+-----------+------------------+------------------+------------+------------------
 testNs | public           | testNs          | _sysinternal           | _hyper_1                | _sysinternal     | _hyper_1_root   | _sysinternal         | _hyper_1_distinct   |                  1 | STICKY    | time             | bigint           | Test1      |       1073741824
(1 row)

SELECT set_is_distinct_flag('"public"."testNs"', 'Device_id', TRUE);
 set_is_distinct_flag 
----------------------
 
(1 row)

\c meta 
SELECT *
FROM partition_replica;
 id | partition_id | hypertable_name | replica_id | schema_name  |       table_name       
----+--------------+-----------------+------------+--------------+------------------------
  1 |            1 | testNs          |          0 | _sysinternal | _hyper_1_1_0_partition
  2 |            2 | testNs          |          0 | _sysinternal | _hyper_1_2_0_partition
(2 rows)

SELECT *
FROM _meta.get_or_create_chunk(1, 1257894000000000000 :: BIGINT);
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

SELECT *
FROM node;
 database_name | schema_name  | server_name | hostname  | active | id 
---------------+--------------+-------------+-----------+--------+----
 Test1         | remote_Test1 | Test1       | localhost | t      |  1
 test2         | remote_test2 | test2       | localhost | t      |  2
(2 rows)

SELECT *
FROM meta;
 database_name | hostname  | server_name 
---------------+-----------+-------------
 meta          | localhost | meta
(1 row)

SELECT *
FROM hypertable;
  name  | main_schema_name | main_table_name | associated_schema_name | associated_table_prefix | root_schema_name | root_table_name | distinct_schema_name | distinct_table_name | replication_factor | placement | time_column_name | time_column_type | created_on | chunk_size_bytes 
--------+------------------+-----------------+------------------------+-------------------------+------------------+-----------------+----------------------+---------------------+--------------------+-----------+------------------+------------------+------------+------------------
 testNs | public           | testNs          | _sysinternal           | _hyper_1                | _sysinternal     | _hyper_1_root   | _sysinternal         | _hyper_1_distinct   |                  1 | STICKY    | time             | bigint           | Test1      |       1073741824
(1 row)

SELECT *
FROM hypertable_replica;
 hypertable_name | replica_id | schema_name  |     table_name     | distinct_schema_name | distinct_table_name 
-----------------+------------+--------------+--------------------+----------------------+---------------------
 testNs          |          0 | _sysinternal | _hyper_1_0_replica | _sysinternal         | _hyper_1_0_distinct
(1 row)

SELECT *
FROM distinct_replica_node;
 hypertable_name | replica_id | database_name | schema_name  |         table_name         
-----------------+------------+---------------+--------------+----------------------------
 testNs          |          0 | Test1         | _sysinternal | _hyper_1_0_1_distinct_data
(1 row)

SELECT *
FROM partition_epoch;
 id | hypertable_name | start_time | end_time |   partitioning_func   | partitioning_mod | partitioning_column 
----+-----------------+------------+----------+-----------------------+------------------+---------------------
  1 | testNs          |            |          | get_partition_for_key |            32768 | Device_id
(1 row)

SELECT *
FROM partition;
 id | epoch_id | keyspace_start | keyspace_end 
----+----------+----------------+--------------
  1 |        1 |              0 |        16383
  2 |        1 |          16384 |        32767
(2 rows)

SELECT *
FROM partition_replica;
 id | partition_id | hypertable_name | replica_id | schema_name  |       table_name       
----+--------------+-----------------+------------+--------------+------------------------
  1 |            1 | testNs          |          0 | _sysinternal | _hyper_1_1_0_partition
  2 |            2 | testNs          |          0 | _sysinternal | _hyper_1_2_0_partition
(2 rows)

SELECT *
FROM chunk;
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

SELECT *
FROM chunk_replica_node;
 chunk_id | partition_replica_id | database_name | schema_name  |     table_name      
----------+----------------------+---------------+--------------+---------------------
        1 |                    1 | Test1         | _sysinternal | _hyper_1_1_0_1_data
(1 row)

SELECT *
FROM field;
 hypertable_name |                              name                               | attnum |    data_type     | default_value | is_distinct | not_null | created_on | modified_on 
-----------------+-----------------------------------------------------------------+--------+------------------+---------------+-------------+----------+------------+-------------
 testNs          | time                                                            |      1 | bigint           |               | f           | t        | Test1      | Test1
 testNs          | temp                                                            |      3 | double precision |               | f           | f        | Test1      | Test1
 testNs          | occupied                                                        |      4 | boolean          |               | f           | f        | Test1      | Test1
 testNs          | latitude                                                        |      5 | bigint           |               | f           | f        | Test1      | Test1
 testNs          | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an |      6 | bigint           |               | f           | f        | Test1      | Test1
 testNs          | Device_id                                                       |      2 | text             |               | t           | t        | Test1      | Test1
(6 rows)

\des+
                                                     List of foreign servers
 Name  |  Owner   | Foreign-data wrapper | Access privileges | Type | Version |            FDW Options             | Description 
-------+----------+----------------------+-------------------+------+---------+------------------------------------+-------------
 Test1 | postgres | postgres_fdw         |                   |      |         | (host 'localhost', dbname 'Test1') | 
 test2 | postgres | postgres_fdw         |                   |      |         | (host 'localhost', dbname 'test2') | 
(2 rows)

\deu+
                 List of user mappings
 Server | User name |           FDW Options            
--------+-----------+----------------------------------
 Test1  | postgres  | ("user" 'postgres', password '')
 test2  | postgres  | ("user" 'postgres', password '')
(2 rows)

\echo *********************************************************************************************************ß
*********************************************************************************************************ß
\c Test1
SELECT *
FROM node;
 database_name | schema_name  | server_name | hostname  | active | id 
---------------+--------------+-------------+-----------+--------+----
 Test1         | remote_Test1 | Test1       | localhost | t      |  1
 test2         | remote_test2 | test2       | localhost | t      |  2
(2 rows)

SELECT *
FROM meta;
 database_name | hostname  | server_name 
---------------+-----------+-------------
 meta          | localhost | meta
(1 row)

SELECT *
FROM hypertable;
  name  | main_schema_name | main_table_name | associated_schema_name | associated_table_prefix | root_schema_name | root_table_name | distinct_schema_name | distinct_table_name | replication_factor | placement | time_column_name | time_column_type | created_on | chunk_size_bytes 
--------+------------------+-----------------+------------------------+-------------------------+------------------+-----------------+----------------------+---------------------+--------------------+-----------+------------------+------------------+------------+------------------
 testNs | public           | testNs          | _sysinternal           | _hyper_1                | _sysinternal     | _hyper_1_root   | _sysinternal         | _hyper_1_distinct   |                  1 | STICKY    | time             | bigint           | Test1      |       1073741824
(1 row)

SELECT *
FROM hypertable_replica;
 hypertable_name | replica_id | schema_name  |     table_name     | distinct_schema_name | distinct_table_name 
-----------------+------------+--------------+--------------------+----------------------+---------------------
 testNs          |          0 | _sysinternal | _hyper_1_0_replica | _sysinternal         | _hyper_1_0_distinct
(1 row)

SELECT *
FROM distinct_replica_node;
 hypertable_name | replica_id | database_name | schema_name  |         table_name         
-----------------+------------+---------------+--------------+----------------------------
 testNs          |          0 | Test1         | _sysinternal | _hyper_1_0_1_distinct_data
(1 row)

SELECT *
FROM partition_epoch;
 id | hypertable_name | start_time | end_time |   partitioning_func   | partitioning_mod | partitioning_column 
----+-----------------+------------+----------+-----------------------+------------------+---------------------
  1 | testNs          |            |          | get_partition_for_key |            32768 | Device_id
(1 row)

SELECT *
FROM partition;
 id | epoch_id | keyspace_start | keyspace_end 
----+----------+----------------+--------------
  1 |        1 |              0 |        16383
  2 |        1 |          16384 |        32767
(2 rows)

SELECT *
FROM partition_replica;
 id | partition_id | hypertable_name | replica_id | schema_name  |       table_name       
----+--------------+-----------------+------------+--------------+------------------------
  1 |            1 | testNs          |          0 | _sysinternal | _hyper_1_1_0_partition
  2 |            2 | testNs          |          0 | _sysinternal | _hyper_1_2_0_partition
(2 rows)

SELECT *
FROM chunk;
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

SELECT *
FROM chunk_replica_node;
 chunk_id | partition_replica_id | database_name | schema_name  |     table_name      
----------+----------------------+---------------+--------------+---------------------
        1 |                    1 | Test1         | _sysinternal | _hyper_1_1_0_1_data
(1 row)

SELECT *
FROM field;
 hypertable_name |                              name                               | attnum |    data_type     | default_value | is_distinct | not_null | created_on | modified_on 
-----------------+-----------------------------------------------------------------+--------+------------------+---------------+-------------+----------+------------+-------------
 testNs          | time                                                            |      1 | bigint           |               | f           | t        | Test1      | Test1
 testNs          | temp                                                            |      3 | double precision |               | f           | f        | Test1      | Test1
 testNs          | occupied                                                        |      4 | boolean          |               | f           | f        | Test1      | Test1
 testNs          | latitude                                                        |      5 | bigint           |               | f           | f        | Test1      | Test1
 testNs          | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an |      6 | bigint           |               | f           | f        | Test1      | Test1
 testNs          | Device_id                                                       |      2 | text             |               | t           | t        | Test1      | Test1
(6 rows)

\des+
                                                     List of foreign servers
 Name  |  Owner   | Foreign-data wrapper | Access privileges | Type | Version |            FDW Options             | Description 
-------+----------+----------------------+-------------------+------+---------+------------------------------------+-------------
 meta  | postgres | postgres_fdw         |                   |      |         | (host 'localhost', dbname 'meta')  | 
 test2 | postgres | postgres_fdw         |                   |      |         | (host 'localhost', dbname 'test2') | 
(2 rows)

\deu+
                 List of user mappings
 Server | User name |           FDW Options            
--------+-----------+----------------------------------
 meta   | postgres  | ("user" 'postgres', password '')
 test2  | postgres  | ("user" 'postgres', password '')
(2 rows)

\d+ "_sysinternal".*
Index "_sysinternal.1-testNs_Device_id_time_idx"
  Column   |  Type  | Definition  | Storage  
-----------+--------+-------------+----------
 Device_id | text   | "Device_id" | extended
 time      | bigint | "time"      | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate ("Device_id" IS NOT NULL)

                                 Index "_sysinternal.2-testNs_really_long_field_goes_on_and_on_and_on_and_on_and_o_i"
                             Column                              |  Type  |                           Definition                            | Storage 
-----------------------------------------------------------------+--------+-----------------------------------------------------------------+---------
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | plain
 time                                                            | bigint | "time"                                                          | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL)

   Index "_sysinternal.3-testNs_temp_time_idx"
 Column |       Type       | Definition | Storage 
--------+------------------+------------+---------
 temp   | double precision | temp       | plain
 time   | bigint           | "time"     | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (temp IS NOT NULL)

                                 Index "_sysinternal.4-testNs_time_really_long_field_goes_on_and_on_and_on_and_on__i"
                             Column                              |  Type  |                           Definition                            | Storage 
-----------------------------------------------------------------+--------+-----------------------------------------------------------------+---------
 time                                                            | bigint | "time"                                                          | plain
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL)

          Table "_sysinternal._hyper_1_0_1_distinct_data"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Indexes:
    "_hyper_1_0_1_distinct_data_pkey" PRIMARY KEY, btree (field, value)
Inherits: _sysinternal._hyper_1_0_distinct

Index "_sysinternal._hyper_1_0_1_distinct_data_pkey"
 Column | Type | Definition | Storage  
--------+------+------------+----------
 field  | text | field      | extended
 value  | text | value      | extended
primary key, btree, for table "_sysinternal._hyper_1_0_1_distinct_data"

             Table "_sysinternal._hyper_1_0_distinct"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Inherits: _sysinternal._hyper_1_distinct
Child tables: _sysinternal._hyper_1_0_1_distinct_data

                                                Table "_sysinternal._hyper_1_0_replica"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Inherits: _sysinternal._hyper_1_root
Child tables: _sysinternal._hyper_1_1_0_partition,
              _sysinternal._hyper_1_2_0_partition

                                                Table "_sysinternal._hyper_1_1_0_1_data"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Indexes:
    "1-testNs_Device_id_time_idx" btree ("Device_id", "time" DESC NULLS LAST) WHERE "Device_id" IS NOT NULL
    "2-testNs_really_long_field_goes_on_and_on_and_on_and_on_and_o_i" btree (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an, "time" DESC NULLS LAST) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL
    "3-testNs_temp_time_idx" btree (temp, "time" DESC NULLS LAST) WHERE temp IS NOT NULL
    "4-testNs_time_really_long_field_goes_on_and_on_and_on_and_on__i" btree ("time" DESC NULLS LAST, really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '0'::smallint AND get_partition_for_key("Device_id", 32768) <= '16383'::smallint)
Inherits: _sysinternal._hyper_1_1_0_partition

                                              Table "_sysinternal._hyper_1_1_0_partition"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '0'::smallint AND get_partition_for_key("Device_id", 32768) <= '16383'::smallint)
Inherits: _sysinternal._hyper_1_0_replica
Child tables: _sysinternal._hyper_1_1_0_1_data

                                              Table "_sysinternal._hyper_1_2_0_partition"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '16384'::smallint AND get_partition_for_key("Device_id", 32768) <= '32767'::smallint)
Inherits: _sysinternal._hyper_1_0_replica

              Table "_sysinternal._hyper_1_distinct"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Indexes:
    "_hyper_1_distinct_pkey" PRIMARY KEY, btree (field, value)
Child tables: _sysinternal._hyper_1_0_distinct

Index "_sysinternal._hyper_1_distinct_pkey"
 Column | Type | Definition | Storage  
--------+------+------------+----------
 field  | text | field      | extended
 value  | text | value      | extended
primary key, btree, for table "_sysinternal._hyper_1_distinct"

                                                   Table "_sysinternal._hyper_1_root"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Child tables: _sysinternal._hyper_1_0_replica

--\d+ "_sys_1_testNs"."_sys_1_testNs_1_0_partition"
--\d+ "_sys_1_testNs"."_sys_1_testNs_2_0_partition"
--\det "_sys_1_testNs".*
--\d+ "testNs".distinct
--test idempotence
\c meta
SELECT *
FROM _meta.get_or_create_chunk(1, 1257894000000000000 :: BIGINT);
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

\c Test1
\d+ "_sysinternal".*
Index "_sysinternal.1-testNs_Device_id_time_idx"
  Column   |  Type  | Definition  | Storage  
-----------+--------+-------------+----------
 Device_id | text   | "Device_id" | extended
 time      | bigint | "time"      | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate ("Device_id" IS NOT NULL)

                                 Index "_sysinternal.2-testNs_really_long_field_goes_on_and_on_and_on_and_on_and_o_i"
                             Column                              |  Type  |                           Definition                            | Storage 
-----------------------------------------------------------------+--------+-----------------------------------------------------------------+---------
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | plain
 time                                                            | bigint | "time"                                                          | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL)

   Index "_sysinternal.3-testNs_temp_time_idx"
 Column |       Type       | Definition | Storage 
--------+------------------+------------+---------
 temp   | double precision | temp       | plain
 time   | bigint           | "time"     | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (temp IS NOT NULL)

                                 Index "_sysinternal.4-testNs_time_really_long_field_goes_on_and_on_and_on_and_on__i"
                             Column                              |  Type  |                           Definition                            | Storage 
-----------------------------------------------------------------+--------+-----------------------------------------------------------------+---------
 time                                                            | bigint | "time"                                                          | plain
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL)

          Table "_sysinternal._hyper_1_0_1_distinct_data"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Indexes:
    "_hyper_1_0_1_distinct_data_pkey" PRIMARY KEY, btree (field, value)
Inherits: _sysinternal._hyper_1_0_distinct

Index "_sysinternal._hyper_1_0_1_distinct_data_pkey"
 Column | Type | Definition | Storage  
--------+------+------------+----------
 field  | text | field      | extended
 value  | text | value      | extended
primary key, btree, for table "_sysinternal._hyper_1_0_1_distinct_data"

             Table "_sysinternal._hyper_1_0_distinct"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Inherits: _sysinternal._hyper_1_distinct
Child tables: _sysinternal._hyper_1_0_1_distinct_data

                                                Table "_sysinternal._hyper_1_0_replica"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Inherits: _sysinternal._hyper_1_root
Child tables: _sysinternal._hyper_1_1_0_partition,
              _sysinternal._hyper_1_2_0_partition

                                                Table "_sysinternal._hyper_1_1_0_1_data"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Indexes:
    "1-testNs_Device_id_time_idx" btree ("Device_id", "time" DESC NULLS LAST) WHERE "Device_id" IS NOT NULL
    "2-testNs_really_long_field_goes_on_and_on_and_on_and_on_and_o_i" btree (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an, "time" DESC NULLS LAST) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL
    "3-testNs_temp_time_idx" btree (temp, "time" DESC NULLS LAST) WHERE temp IS NOT NULL
    "4-testNs_time_really_long_field_goes_on_and_on_and_on_and_on__i" btree ("time" DESC NULLS LAST, really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '0'::smallint AND get_partition_for_key("Device_id", 32768) <= '16383'::smallint)
Inherits: _sysinternal._hyper_1_1_0_partition

                                              Table "_sysinternal._hyper_1_1_0_partition"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '0'::smallint AND get_partition_for_key("Device_id", 32768) <= '16383'::smallint)
Inherits: _sysinternal._hyper_1_0_replica
Child tables: _sysinternal._hyper_1_1_0_1_data

                                              Table "_sysinternal._hyper_1_2_0_partition"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '16384'::smallint AND get_partition_for_key("Device_id", 32768) <= '32767'::smallint)
Inherits: _sysinternal._hyper_1_0_replica

              Table "_sysinternal._hyper_1_distinct"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Indexes:
    "_hyper_1_distinct_pkey" PRIMARY KEY, btree (field, value)
Child tables: _sysinternal._hyper_1_0_distinct

Index "_sysinternal._hyper_1_distinct_pkey"
 Column | Type | Definition | Storage  
--------+------+------------+----------
 field  | text | field      | extended
 value  | text | value      | extended
primary key, btree, for table "_sysinternal._hyper_1_distinct"

                                                   Table "_sysinternal._hyper_1_root"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Child tables: _sysinternal._hyper_1_0_replica

\c meta
SELECT _meta.close_chunk_end(1);
 close_chunk_end 
-----------------
 
(1 row)

SELECT *
FROM chunk;
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

SELECT *
FROM _meta.get_or_create_chunk(1, 10 :: BIGINT);
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

SELECT *
FROM _meta.get_or_create_chunk(1, 1257894000000000000 :: BIGINT);
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

SELECT *
FROM chunk;
 id | partition_id | start_time | end_time 
----+--------------+------------+----------
  1 |            1 |            |         
(1 row)

\c Test1
\d+ "_sysinternal".*
Index "_sysinternal.1-testNs_Device_id_time_idx"
  Column   |  Type  | Definition  | Storage  
-----------+--------+-------------+----------
 Device_id | text   | "Device_id" | extended
 time      | bigint | "time"      | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate ("Device_id" IS NOT NULL)

                                 Index "_sysinternal.2-testNs_really_long_field_goes_on_and_on_and_on_and_on_and_o_i"
                             Column                              |  Type  |                           Definition                            | Storage 
-----------------------------------------------------------------+--------+-----------------------------------------------------------------+---------
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | plain
 time                                                            | bigint | "time"                                                          | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL)

   Index "_sysinternal.3-testNs_temp_time_idx"
 Column |       Type       | Definition | Storage 
--------+------------------+------------+---------
 temp   | double precision | temp       | plain
 time   | bigint           | "time"     | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (temp IS NOT NULL)

                                 Index "_sysinternal.4-testNs_time_really_long_field_goes_on_and_on_and_on_and_on__i"
                             Column                              |  Type  |                           Definition                            | Storage 
-----------------------------------------------------------------+--------+-----------------------------------------------------------------+---------
 time                                                            | bigint | "time"                                                          | plain
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint | really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | plain
btree, for table "_sysinternal._hyper_1_1_0_1_data", predicate (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL)

          Table "_sysinternal._hyper_1_0_1_distinct_data"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Indexes:
    "_hyper_1_0_1_distinct_data_pkey" PRIMARY KEY, btree (field, value)
Inherits: _sysinternal._hyper_1_0_distinct

Index "_sysinternal._hyper_1_0_1_distinct_data_pkey"
 Column | Type | Definition | Storage  
--------+------+------------+----------
 field  | text | field      | extended
 value  | text | value      | extended
primary key, btree, for table "_sysinternal._hyper_1_0_1_distinct_data"

             Table "_sysinternal._hyper_1_0_distinct"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Inherits: _sysinternal._hyper_1_distinct
Child tables: _sysinternal._hyper_1_0_1_distinct_data

                                                Table "_sysinternal._hyper_1_0_replica"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Inherits: _sysinternal._hyper_1_root
Child tables: _sysinternal._hyper_1_1_0_partition,
              _sysinternal._hyper_1_2_0_partition

                                                Table "_sysinternal._hyper_1_1_0_1_data"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Indexes:
    "1-testNs_Device_id_time_idx" btree ("Device_id", "time" DESC NULLS LAST) WHERE "Device_id" IS NOT NULL
    "2-testNs_really_long_field_goes_on_and_on_and_on_and_on_and_o_i" btree (really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an, "time" DESC NULLS LAST) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL
    "3-testNs_temp_time_idx" btree (temp, "time" DESC NULLS LAST) WHERE temp IS NOT NULL
    "4-testNs_time_really_long_field_goes_on_and_on_and_on_and_on__i" btree ("time" DESC NULLS LAST, really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an) WHERE really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an IS NOT NULL
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '0'::smallint AND get_partition_for_key("Device_id", 32768) <= '16383'::smallint)
Inherits: _sysinternal._hyper_1_1_0_partition

                                              Table "_sysinternal._hyper_1_1_0_partition"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '0'::smallint AND get_partition_for_key("Device_id", 32768) <= '16383'::smallint)
Inherits: _sysinternal._hyper_1_0_replica
Child tables: _sysinternal._hyper_1_1_0_1_data

                                              Table "_sysinternal._hyper_1_2_0_partition"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Check constraints:
    "partition" CHECK (get_partition_for_key("Device_id", 32768) >= '16384'::smallint AND get_partition_for_key("Device_id", 32768) <= '32767'::smallint)
Inherits: _sysinternal._hyper_1_0_replica

              Table "_sysinternal._hyper_1_distinct"
 Column | Type | Modifiers | Storage  | Stats target | Description 
--------+------+-----------+----------+--------------+-------------
 field  | text | not null  | extended |              | 
 value  | text | not null  | extended |              | 
Indexes:
    "_hyper_1_distinct_pkey" PRIMARY KEY, btree (field, value)
Child tables: _sysinternal._hyper_1_0_distinct

Index "_sysinternal._hyper_1_distinct_pkey"
 Column | Type | Definition | Storage  
--------+------+------------+----------
 field  | text | field      | extended
 value  | text | value      | extended
primary key, btree, for table "_sysinternal._hyper_1_distinct"

                                                   Table "_sysinternal._hyper_1_root"
                             Column                              |       Type       | Modifiers | Storage  | Stats target | Description 
-----------------------------------------------------------------+------------------+-----------+----------+--------------+-------------
 time                                                            | bigint           | not null  | plain    |              | 
 Device_id                                                       | text             | not null  | extended |              | 
 temp                                                            | double precision |           | plain    |              | 
 occupied                                                        | boolean          |           | plain    |              | 
 latitude                                                        | bigint           |           | plain    |              | 
 really_long_field_goes_on_and_on_and_on_and_on_and_on_and_on_an | bigint           |           | plain    |              | 
Child tables: _sysinternal._hyper_1_0_replica

